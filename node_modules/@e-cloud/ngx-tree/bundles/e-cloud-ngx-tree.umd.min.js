!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("lodash-es/defaults"),require("lodash-es/defaultsDeep"),require("lodash-es/isNumber"),require("lodash-es/first"),require("lodash-es/last"),require("lodash-es/pullAt"),require("lodash-es/without"),require("lodash-es/compact"),require("lodash-es/find"),require("lodash-es/isFunction"),require("lodash-es/isString"),require("rxjs"),require("@angular/core"),require("rxjs/operators"),require("@angular/animations"),require("element-closest"),require("lodash-es/each"),require("@angular/common")):"function"==typeof define&&define.amd?define("@e-cloud/ngx-tree",["exports","lodash-es/defaults","lodash-es/defaultsDeep","lodash-es/isNumber","lodash-es/first","lodash-es/last","lodash-es/pullAt","lodash-es/without","lodash-es/compact","lodash-es/find","lodash-es/isFunction","lodash-es/isString","rxjs","@angular/core","rxjs/operators","@angular/animations","element-closest","lodash-es/each","@angular/common"],t):t((e["e-cloud"]=e["e-cloud"]||{},e["e-cloud"]["ngx-tree"]={}),e.defaults,e.defaultsDeep,e.isNumber,e.first,e.last,e.pullAt,e.without,e.compact,e.find,e.isFunction,e.isString,e.rxjs,e.ng.core,e.Rx.Observable.prototype,e.ng.animations,null,e.each,e.ng.common)}(this,function(e,n,t,o,i,r,s,l,a,p,d,c,u,h,g,f,v,y,m){"use strict";n=n&&n.hasOwnProperty("default")?n["default"]:n,t=t&&t.hasOwnProperty("default")?t["default"]:t,o=o&&o.hasOwnProperty("default")?o["default"]:o,i=i&&i.hasOwnProperty("default")?i["default"]:i,r=r&&r.hasOwnProperty("default")?r["default"]:r,s=s&&s.hasOwnProperty("default")?s["default"]:s,l=l&&l.hasOwnProperty("default")?l["default"]:l,a=a&&a.hasOwnProperty("default")?a["default"]:a,p=p&&p.hasOwnProperty("default")?p["default"]:p,d=d&&d.hasOwnProperty("default")?d["default"]:d,c=c&&c.hasOwnProperty("default")?c["default"]:c,y=y&&y.hasOwnProperty("default")?y["default"]:y;var b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};function N(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,i,r=n.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(o=r.next()).done;)s.push(o.value)}catch(l){i={error:l}}finally{try{o&&!o.done&&(n=r["return"])&&n.call(r)}finally{if(i)throw i.error}}return s}function E(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(N(arguments[t]));return e}var x={LEFT:37,UP:38,RIGHT:39,DOWN:40,ENTER:13,SPACE:32},w={TOGGLE_SELECTED:function(e,t,n){return t&&t.toggleActivated()},TOGGLE_SELECTED_MULTI:function(e,t,n){return t&&t.toggleActivated(!0)},SELECT:function(e,t,n){return t.setActive(!0)},DESELECT:function(e,t,n){return t.setActive(!1)},FOCUS:function(e,t,n){return t.focus()},TOGGLE_EXPANDED:function(e,t,n){return n.stopPropagation(),t.hasChildren&&t.toggleExpanded()},EXPAND:function(e,t,n){return t.expand()},COLLAPSE:function(e,t,n){return t.collapse()},DRILL_DOWN:function(e,t,n){return e.focusDrillDown()},DRILL_UP:function(e,t,n){return e.focusDrillUp()},NEXT_NODE:function(e,t,n){return e.focusNextNode()},PREVIOUS_NODE:function(e,t,n){return e.focusPreviousNode()},MOVE_NODE:function(e,t,n,o){var i=o.from,r=o.to;e.moveNode(i,r)}},D={mouse:{click:w.TOGGLE_SELECTED,dblClick:null,contextMenu:null,expanderClick:w.TOGGLE_EXPANDED,drop:w.MOVE_NODE},keys:(ee={},ee[x.RIGHT]=w.DRILL_DOWN,ee[x.LEFT]=w.DRILL_UP,ee[x.DOWN]=w.NEXT_NODE,ee[x.UP]=w.PREVIOUS_NODE,ee[x.SPACE]=w.TOGGLE_SELECTED,ee[x.ENTER]=w.TOGGLE_SELECTED,ee)},C={allowDrag:!1,allowDrop:!1,levelPadding:function(){return"0px"},useVirtualScroll:!1,nodeClass:function(){return""}},T={childrenField:"children",displayField:"name",idField:"id",isExpandedField:"isExpanded",actionMapping:D,getChildren:function(e){return null}};function I(e){void 0===e&&(e={});var t=e.levelPadding;return o(t)&&(e.levelPadding=function(e){return t+t*(e.level-1)+"px"}),n({},e,C)}function O(e){return void 0===e&&(e={}),t({},e,T)}var A={expand:"expand",collapse:"collapse",toggleExpander:"toggleExpander",activate:"activate",deactivate:"deactivate",focus:"focus",blur:"blur",initialized:"initialized",moveNode:"moveNode",loadChildren:"loadChildren",changeFilter:"changeFilter",removeNode:"removeNode",addNode:"addNode"},S=function(){function o(e,t,n,o){this.data=e,this.parent=t,this.treeModel=n,this.index=o,this.position=0,this.height=0,this.loadingChildren=!1,this.id!==undefined&&null!==this.id||(this.id="ngx-tid-"+M++),n.addCache(this),e[this.options.isExpandedField]&&n.setExpandedNodeInPlace(this),this.getField("children")&&this.initChildren()}return Object.defineProperty(o.prototype,"isHidden",{get:function(){return this.treeModel.isNodeHidden(this)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"isExpanded",{get:function(){return this.treeModel.isNodeExpanded(this)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"isCollapsed",{get:function(){return!this.isExpanded},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"isActive",{get:function(){return this.treeModel.isNodeActive(this)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"isFocused",{get:function(){return this.treeModel.isNodeFocused(this)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"isLeaf",{get:function(){return!this.hasChildren},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"isRoot",{get:function(){return null===this.parent},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"level",{get:function(){return this.parent?this.parent.level+1:0},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"path",{get:function(){return this.parent?E(this.parent.path,[this.id]):[]},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"hasChildren",{get:function(){return!!(this.data.hasChildren||this.children&&0<this.children.length)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"hasVisibleChildren",{get:function(){return!!(this.data.hasChildren||this.visibleChildren&&0<this.visibleChildren.length)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"options",{get:function(){return this.treeModel.options},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"displayField",{get:function(){return this.getField("display")},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"id",{get:function(){return this.getField("id")},set:function(e){this.setField("id",e)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"visibleChildren",{get:function(){return(this.children||[]).filter(function(e){return!e.isHidden})},enumerable:!0,configurable:!0}),o.prototype.fireEvent=function(e){this.treeModel.fireEvent(e)},o.prototype.getField=function(e){return this.data[this.options[e+"Field"]]},o.prototype.setField=function(e,t){this.data[this.options[e+"Field"]]=t},o.prototype.onDrop=function(e){this.mouseAction("drop",e.event,{from:e.element,to:{parent:this,index:0,dropOnNode:!0}})},o.prototype.findAdjacentSibling=function(e,t){return void 0===t&&(t=!1),this.getParentChildren(t)[this.index+e]},o.prototype.findNextSibling=function(e){return void 0===e&&(e=!1),this.findAdjacentSibling(1,e)},o.prototype.findPreviousSibling=function(e){return void 0===e&&(e=!1),this.findAdjacentSibling(-1,e)},o.prototype.getFirstChild=function(e){void 0===e&&(e=!1);var t=e?this.visibleChildren:this.children;return i(t||[])},o.prototype.getLastChild=function(e){void 0===e&&(e=!1);var t=e?this.visibleChildren:this.children;return r(t||[])},o.prototype.findNextNode=function(e,t){return void 0===e&&(e=!0),void 0===t&&(t=!1),e&&this.isExpanded&&this.getFirstChild(t)||this.findNextSibling(t)||this.parent&&this.parent.findNextNode(!1,t)},o.prototype.findPreviousNode=function(e){void 0===e&&(e=!1);var t=this.findPreviousSibling(e);return t?t.getLastOpenDescendant(e):this.parent},o.prototype.isDescendantOf=function(e){return this===e||this.parent&&this.parent.isDescendantOf(e)},o.prototype.loadChildren=function(){var t=this;return this.options.getChildren?(this.loadingChildren=!0,Promise.resolve(this.options.getChildren(this)).then(function(e){e&&(t.setField("children",e),t.initChildren())}).then(function(){t.loadingChildren=!1,t.fireEvent({eventName:A.loadChildren,node:t})})):Promise.resolve()},o.prototype.expand=function(){return this.isExpanded?Promise.resolve():this.toggleExpanded()},o.prototype.collapse=function(){return this.isExpanded&&this.toggleExpanded(),this},o.prototype.traverse=function(t){var e=this;Promise.resolve(t(this)).then(function(){e.children&&e.children.forEach(function(e){return e.traverse(t)})})},o.prototype.expandAll=function(){this.traverse(function(e){return e.expand()})},o.prototype.collapseAll=function(){this.traverse(function(e){return e.collapse()})},o.prototype.toggleExpanded=function(e){return void 0===e&&(e=!this.isExpanded),this.hasChildren&&(this.treeModel.setExpandedNode(this,e),!this.children&&this.hasChildren&&e)?this.loadChildren():Promise.resolve()},o.prototype.setActive=function(e,t){return void 0===e&&(e=!0),void 0===t&&(t=!1),this.treeModel.setActiveNode(this,e,t),this},o.prototype.setHidden=function(e){return void 0===e&&(e=!0),this.treeModel.setHiddenNode(this,e),this},o.prototype.toggleActivated=function(e){return void 0===e&&(e=!1),this.setActive(!this.isActive,e),this},o.prototype.setActiveAndVisible=function(e){return void 0===e&&(e=!1),this.setActive(!0,e).ensureVisible(),this.scrollIntoView(),this},o.prototype.ensureVisible=function(){return this.parent&&(this.parent.expand(),this.parent.ensureVisible()),this},o.prototype.scrollIntoView=function(e,t){void 0===e&&(e=!1),this.treeModel.scrollIntoView(this,e,t)},o.prototype.focus=function(e){void 0===e&&(e=!0);var t=this.treeModel.focusedNode;return this.treeModel.setFocusedNode(this),e&&this.scrollIntoView(),t&&this.fireEvent({eventName:A.blur,node:t}),this.fireEvent({eventName:A.focus,node:this}),this},o.prototype.blur=function(){var e=this.treeModel.focusedNode;return this.treeModel.setFocusedNode(null),e&&this.fireEvent({eventName:A.blur,node:this}),this},o.prototype.hide=function(){return this.setHidden(!0),this},o.prototype.show=function(){return this.setHidden(!1),this},o.prototype.addChild=function(e,t){var n=new o(e,this,this.treeModel,t);this.getField("children")||this.setField("children",[]),this.children?(this.getField("children").splice(t,0,e),this.children.splice(t,0,n),this.children=this.children.slice()):(this.getField("children").push(e),this.children=[n]),this.reCalcChildrenIndices(t),this.fireEvent({eventName:A.addNode,node:n})},o.prototype.appendChild=function(e){this.addChild(e,this.children?this.children.length:0)},o.prototype.remove=function(){this.parent.removeChild(this)},o.prototype.removeChild=function(e){s(this.getField("children"),e.index),this.children=l(this.children,e),this.reCalcChildrenIndices(0),this.fireEvent({eventName:A.removeNode,node:e}),e.isFocused&&(this.treeModel.setFocusedNode(null),this.treeModel.setActiveNode(e,!1)),e.isExpanded&&this.treeModel.setExpandedNodeInPlace(e,!1),e.treeModel=null,e.elementRef=null},o.prototype.mouseAction=function(e,t,n){void 0===n&&(n=null),this.treeModel.setFocus(!0);var o=this.options.actionMapping.mouse[e];o&&o(this.treeModel,this,t,n)},o.prototype.reCalcChildrenIndices=function(n){this.children.slice(n).forEach(function(e,t){e.index=t+n})},o.prototype.initChildren=function(){var n=this;this.children=this.getField("children").map(function(e,t){return new o(e,n,n.treeModel,t)})},o.prototype.getLastOpenDescendant=function(e){void 0===e&&(e=!1);var t=this.getLastChild(e);return this.isCollapsed||!t?this:t.getLastOpenDescendant(e)},o.prototype.getParentChildren=function(e){return void 0===e&&(e=!1),this.parent?e?this.parent.visibleChildren:this.parent.children:[]},o}(),M=0;var P=function(){function t(e,t,n){this.nodes=e,this.events=t,this.options=n,this.scrollIntoView$=new u.Subject,this.focusedNodeId=null,this.expandedNodeIds=new Map,this.activeNodeIds=new Map,this.hiddenNodeIds=new Map,this.nodeCache=new Map,this.options=O(n);var o,i=((o={virtual:!0})[this.options.childrenField]=this.nodes,o);this.virtualRoot=new S(i,null,this,0),this.setExpandedNodeInPlace(this.virtualRoot),this.roots=this.virtualRoot.children}return Object.defineProperty(t.prototype,"isFocused",{get:function(){return t.focusedTree===this},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isEmptyTree",{get:function(){return this.roots&&0===this.roots.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"focusedNode",{get:function(){return this.focusedNodeId?this.getNodeById(this.focusedNodeId):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"expandedNodes",{get:function(){var t=this,e=Array.from(this.expandedNodeIds.keys()).filter(function(e){return t.expandedNodeIds.get(e)}).map(function(e){return t.getNodeById(e)});return a(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activeNodes",{get:function(){var t=this,e=Array.from(this.activeNodeIds.keys()).filter(function(e){return t.activeNodeIds.get(e)}).map(function(e){return t.nodeCache.get(e)});return a(e)},enumerable:!0,configurable:!0}),t.prototype.addCache=function(e){this.nodeCache.set(e.id,e)},t.prototype.updateOptions=function(e){this.options=e},t.prototype.fireEvent=function(e){this.events[e.eventName].emit(e)},t.prototype.subscribe=function(e,t){return this.events[e].subscribe(t)},t.prototype.getActiveNode=function(){return this.activeNodes[0]},t.prototype.getVisibleRoots=function(){return this.virtualRoot.visibleChildren},t.prototype.getFirstRoot=function(e){return void 0===e&&(e=!1),i(e?this.getVisibleRoots():this.roots)},t.prototype.getLastRoot=function(e){return void 0===e&&(e=!1),r(e?this.getVisibleRoots():this.roots)},t.prototype.getNodeByPath=function(e,t){if(void 0===t&&(t=null),!e)return null;if(t=t||this.virtualRoot,0===e.length)return t;if(!t.children)return null;var n=e.shift(),o=p(t.children,{id:n});return o?this.getNodeByPath(e,o):null},t.prototype.getNodeById=function(e){return this.nodeCache.get(e)},t.prototype.getNodeBy=function(e,t){if(void 0===t&&(t=null),!(t=t||this.virtualRoot).children)return null;var n,o,i=p(t.children,e);if(i)return i;try{for(var r=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}(t.children),s=r.next();!s.done;s=r.next()){var l=s.value,a=this.getNodeBy(e,l);if(a)return a}}catch(d){n={error:d}}finally{try{s&&!s.done&&(o=r["return"])&&o.call(r)}finally{if(n)throw n.error}}},t.prototype.isNodeExpanded=function(e){return!!this.expandedNodeIds.get(e.id)},t.prototype.isNodeHidden=function(e){return!!this.hiddenNodeIds.get(e.id)},t.prototype.isNodeActive=function(e){return!!this.activeNodeIds.get(e.id)},t.prototype.isNodeFocused=function(e){return this.focusedNode===e},t.prototype.setActiveNode=function(e,t,n){void 0===n&&(n=!1),n?this.setMultiActiveNodes(e,t):this.setSingleActiveNode(e,t),t?(e.focus(),this.fireEvent({eventName:A.activate,node:e})):this.fireEvent({eventName:A.deactivate,node:e})},t.prototype.setExpandedNodeInPlace=function(e,t){void 0===t&&(t=!0),this.expandedNodeIds.set(e.id,t)},t.prototype.setExpandedNode=function(e,t){void 0===t&&(t=!0),this.expandedNodeIds.set(e.id,t),t?this.fireEvent({eventName:A.expand,node:e}):this.fireEvent({eventName:A.collapse,node:e}),this.fireEvent({eventName:A.toggleExpander,node:e,isExpanded:t})},t.prototype.setHiddenNode=function(e,t){void 0===t&&(t=!0),this.hiddenNodeIds.set(e.id,t)},t.prototype.setFocusedNode=function(e){this.focusedNodeId=e?e.id:null},t.prototype.setFocus=function(e){t.focusedTree=e?this:null},t.prototype.traverse=function(t){this.roots.forEach(function(e){return e.traverse(t)})},t.prototype.activateNode=function(e){var t=this.getNodeById(e);return!!t&&(t.setActiveAndVisible(),!0)},t.prototype.focusNode=function(e){var t=this.getNodeById(e);return!!t&&(t.focus(),!0)},t.prototype.focusNextNode=function(){var e=this.focusedNode,t=e?e.findNextNode(!0,!0):this.getFirstRoot(!0);t&&t.focus()},t.prototype.focusPreviousNode=function(){var e=this.focusedNode,t=e?e.findPreviousNode(!0):this.getLastRoot(!0);t&&t.focus()},t.prototype.focusDrillDown=function(){var e=this.focusedNode;if(e&&e.isCollapsed&&e.hasChildren)e.toggleExpanded();else{var t=e?e.getFirstChild(!0):this.getFirstRoot(!0);t&&t.focus()}},t.prototype.focusDrillUp=function(){var e=this.focusedNode;if(e)if(e.isExpanded)e.toggleExpanded();else{var t=e.parent;t&&t.focus()}},t.prototype.expandAll=function(){this.roots.forEach(function(e){return e.expandAll()})},t.prototype.collapseAll=function(){this.roots.forEach(function(e){return e.collapseAll()})},t.prototype.performKeyAction=function(e,t){var n=this.options.actionMapping.keys[t.keyCode];return!!n&&(t.preventDefault(),n(this,e,t),!0)},t.prototype.filterNodes=function(t,n){var o,i=this;if(void 0===n&&(n=!0),!t)return this.clearFilter();if(c(t))o=function(e){return e.displayField.toLowerCase().includes(t.toLowerCase())};else{if(!d(t))throw new TypeError("Don't know what to do with filter: "+t+". It should be either a string or function");o=t}var r=new Map;this.roots.forEach(function(e){return i.filterNode(r,e,o,n)}),this.hiddenNodeIds=r,this.fireEvent({eventName:A.changeFilter})},t.prototype.clearFilter=function(){this.hiddenNodeIds=new Map,this.fireEvent({eventName:A.changeFilter})},t.prototype.moveNode=function(e,t){var n=e.index,o=e.parent;if(function(e,t,n){if(e.parent===n.parent&&t===n.index)return!1;return!n.parent.isDescendantOf(e)}(e,n,t)){e.remove();var i=o===t.parent&&t.index>n?t.index-1:t.index;t.dropOnNode?t.parent.appendChild(e.data):t.parent.addChild(e.data,i),this.fireEvent({eventName:A.moveNode,node:e,to:{parent:t.parent.data,index:i}})}},t.prototype.scrollIntoView=function(e,t,n){this.scrollIntoView$.next({node:e,force:t,scrollToMiddle:n})},t.prototype.filterNode=function(t,e,n,o){var i=this,r=n(e);return e.children&&e.children.forEach(function(e){i.filterNode(t,e,n,o)&&(r=!0)}),r||t.set(e.id,!0),o&&r&&e.ensureVisible(),r},t.prototype.setSingleActiveNode=function(t,e){var n=this;this.activeNodes.filter(function(e){return e!==t}).forEach(function(e){n.fireEvent({eventName:A.deactivate,node:e})}),this.activeNodeIds=e?new Map([[t.id,!0]]):new Map},t.prototype.setMultiActiveNodes=function(e,t){this.activeNodeIds.set(e.id,t)},t}();P.focusedTree=null;var R=function(){this.className=!0};R.decorators=[{type:h.Component,args:[{selector:"ngx-tree-loading",template:'<span *ngIf="!template">loading...</span>\n\n<ng-container\n  [ngTemplateOutlet]="template"\n  [ngTemplateOutletContext]="{ $implicit: null, node: node }">\n</ng-container>\n',styles:[":host{white-space:nowrap}"],changeDetection:h.ChangeDetectionStrategy.OnPush}]}],R.propDecorators={template:[{type:h.Input}],node:[{type:h.Input}],className:[{type:h.HostBinding,args:["class.tree-loading"]}]};var k=0,V=new h.InjectionToken("VIRTUAL_SCROLL_NODE_HEIGHT_QUOTA"),F=function(){function e(e){this.quota=e,this.averageNodeHeight=0,this.hasEnoughNodeHeight=!1,this.lastScrollTop=0,this.disabled=!1,this.collectionMonitor$=new u.BehaviorSubject(null),this.nodeHeightAnalytics$=new u.Subject,this.id=k++,this.collectAverageNodeHeight()}return e.prototype.adjustViewport=function(e,t){this.lastScrollTop=t,this.currentViewport=e;var n=3*this.averageNodeHeight,o=n<t?t-n:0,i=e.height+t+n;this.collectionMonitor$.next({startPos:o,endPos:i})},e.prototype.waitForCollection=function(e){return this.collectionMonitor$.pipe(g.filter(function(e){return!!e})).subscribe(e)},e.prototype.reportNodeHeight=function(e){this.nodeHeightAnalytics$.next(e)},e.prototype.reCalcPositions=function(e){e.roots.forEach(function(e){e.position=0}),e.virtualRoot.height=this.getPositionAfter(e.getVisibleRoots(),0)},e.prototype.setDisabled=function(e){this.disabled=e},e.prototype.isDisabled=function(){return this.disabled},e.prototype.scrollIntoView=function(e,t,n){return void 0===n&&(n=!0),t||e.position<this.lastScrollTop||e.position+this.averageNodeHeight>this.lastScrollTop+this.currentViewport.height?n?e.position-this.currentViewport.height/2+this.averageNodeHeight:e.position:null},e.prototype.getPositionAfter=function(e,t){var n=this,o=t;return e.forEach(function(e){e.position=o,o=n.getPositionAfterNode(e,e.position,e.isHidden)}),o},e.prototype.getPositionAfterNode=function(e,t,n){void 0===n&&(n=!1);var o=n?t:this.averageNodeHeight+t;return e.children&&e.isExpanded&&(o=this.getPositionAfter(e.visibleChildren,o)),e.height=o-t+(e.loadingChildren?this.averageNodeHeight:0),o},e.prototype.collectAverageNodeHeight=function(){var t=this;this.nodeHeightAnalytics$.pipe(g.scan(function(e,t){var n=e[0]/e[1],o=t+e[0],i=e[1]+1,r=o/i;return 1.5<r/n||1.5<n/r?[t,1]:[o,i]},[0,0])).subscribe(function(e){t.averageNodeHeight=e[0]/e[1],e[1]>=t.quota&&(t.hasEnoughNodeHeight=!0)})},e}();function L(e,t,n){void 0===n&&(n=0);for(var o=n,i=e.length-1;o!==i;){var r=Math.floor((o+i)/2);t(e[r])?i=r:o=o===r?i:r}return o}F.decorators=[{type:h.Injectable}],F.ctorParameters=function(){return[{type:undefined,decorators:[{type:h.Inject,args:[V]}]}]};var H="225ms cubic-bezier(0.4,0.0,0.2,1)",j=function(){function e(e){this.virtualScroll=e,this.marginTop=0,this.viewportNodes=[],this.disableMarginTop=!1,this.refreshTree=!1,this.expandAnimation=!0,this.className=!0,this.scrollSub=u.Subscription.EMPTY}return Object.defineProperty(e.prototype,"noPadding",{get:function(){return!this.options.levelPadding},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"marginTopAttr",{get:function(){return this.disableMarginTop?0:this.marginTop},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){var t=this;this.viewportNodes=this.children,this.scrollSub=this.virtualScroll.waitForCollection(function(e){t.node.treeModel&&t.node.isExpanded&&(t.viewportNodes=t.getViewportNodes(t.node.visibleChildren,e),t.marginTop=t.calcMarginTop())})},e.prototype.ngOnChanges=function(e){"children"in e&&e.children.currentValue&&(this.viewportNodes=this.virtualScroll.isDisabled()||this.refreshTree?this.children:this.viewportNodes)},e.prototype.ngOnDestroy=function(){this.scrollSub.unsubscribe()},e.prototype.trackNode=function(e,t){return t.id},e.prototype.calcMarginTop=function(){var e=this.viewportNodes&&this.viewportNodes.length&&this.viewportNodes[0];return e?Math.max(0,e.position-e.parent.position-(e.parent.isRoot?0:this.virtualScroll.averageNodeHeight)):0},e.prototype.getViewportNodes=function(e,t){var n=t.startPos,o=t.endPos;if(!e||!e.length)return[];var i=L(e,function(e){return n<=e.position||n<=e.position+e.height}),r=L(e,function(e){return o<e.position||o<=e.position+e.height},i);return e.slice(i,r+1)},e}();j.decorators=[{type:h.Component,args:[{selector:"ngx-tree-node-children",template:'<ngx-tree-node *ngFor="let child of viewportNodes; let i = index; trackBy: trackNode"\n               [options]="options"\n               [ngClass]="[options.nodeClass(child), \'tree-node-level-\'+ child.level]"\n               [class.tree-node-expanded]="child.isExpanded"\n               [class.tree-node-collapsed]="child.isCollapsed"\n               [class.tree-node-leaf]="child.isLeaf"\n               [class.tree-node-active]="child.isActive"\n               [class.tree-node-focused]="child.isFocused"\n               [node]="child"\n               [index]="i"\n               [templates]="templates">\n</ngx-tree-node>\n\n<ngx-tree-loading *ngIf="!node.children"\n                  [style.padding-left]="options.levelPadding(node)"\n                  [template]="templates.loadingTemplate"\n                  [node]="node"></ngx-tree-loading>\n',styles:[":host{display:block;padding-left:20px}:host .tree-children-no-padding{padding-left:0}"],animations:[f.trigger("expandAnimation",[f.transition(":enter",[f.style({height:0,overflow:"hidden"}),f.animate(H,f.style({height:"*"}))]),f.transition(":leave",[f.style({height:"*",overflow:"hidden"}),f.animate(H,f.style({height:0}))])])]}]}],j.ctorParameters=function(){return[{type:F}]},j.propDecorators={options:[{type:h.Input}],node:[{type:h.Input}],templates:[{type:h.Input}],disableMarginTop:[{type:h.Input}],children:[{type:h.Input}],refreshTree:[{type:h.Input}],expandAnimation:[{type:h.HostBinding,args:["@expandAnimation"]}],className:[{type:h.HostBinding,args:["class.tree-node-children"]}],noPadding:[{type:h.HostBinding,args:["class.tree-children-no-padding"]}],marginTopAttr:[{type:h.HostBinding,args:["style.margin-top.px"]}]};var G=function(){this.className=!0};G.decorators=[{type:h.Component,args:[{selector:"ngx-tree-node-content",template:'<span *ngIf="!template">{{ node.displayField }}</span>\n\n<ng-container\n  [ngTemplateOutlet]="template"\n  [ngTemplateOutletContext]="{ $implicit: null, node: node, index: index, options: options }">\n</ng-container>\n',styles:[":host{display:block;padding:2px 5px;border-radius:2px;-webkit-transition:background-color .15s,-webkit-box-shadow .15s;transition:background-color .15s,-webkit-box-shadow .15s;transition:background-color .15s,box-shadow .15s;transition:background-color .15s,box-shadow .15s,-webkit-box-shadow .15s;cursor:pointer;white-space:nowrap}"],changeDetection:h.ChangeDetectionStrategy.OnPush}]}],G.propDecorators={options:[{type:h.Input}],node:[{type:h.Input}],index:[{type:h.Input}],template:[{type:h.Input}],className:[{type:h.HostBinding,args:["class.tree-node-content"]}]};var B=function(){function e(){var n=this;this.allowDrop=function(e,t){return!!d(n.options.allowDrop)&&n.options.allowDrop(e,{parent:n.node,index:n.dropIndex},t)}}return e.prototype.onDrop=function(e){this.node.mouseAction("drop",e.event,{from:e.element,to:{parent:this.node,index:this.dropIndex}})},e}();B.decorators=[{type:h.Component,args:[{selector:"ngx-tree-node-drop-slot",template:'<div class="tree-node-drop-slot"\n     (ngxTreeDrop)="onDrop($event)"\n     [treeAllowDrop]="allowDrop">\n</div>\n',styles:[":host{display:block;width:100%;z-index:1}:host.prev-drop-slot{top:0}:host.next-drop-slot{bottom:0}.tree-node-drop-slot{display:block;height:4px;background-color:#f08080}.tree-node-drop-slot.is-dragging-over{background:#dfe;outline:#888 dashed 2px}"],changeDetection:h.ChangeDetectionStrategy.OnPush}]}],B.propDecorators={node:[{type:h.Input}],options:[{type:h.Input}],dropIndex:[{type:h.Input}]};var Z=function(){this.className=!0};Z.decorators=[{type:h.Component,args:[{selector:"ngx-tree-node-expander",template:'<ng-template [ngIf]="!template">\n  <div *ngIf="node.hasChildren"\n        class="toggle-children-wrapper"\n        [class.toggle-children-expanded]="node.isExpanded"\n        [class.toggle-children-collapsed]="node.isCollapsed"\n        (click)="node.mouseAction(\'expanderClick\', $event)">\n    <span class="toggle-children"></span>\n  </div>\n\n  <div *ngIf="!node.hasChildren"\n        class="toggle-children-placeholder"></div>\n</ng-template>\n\n<ng-container [ngTemplateOutlet]="template"\n              [ngTemplateOutletContext]="{\n                $implicit: null,\n                node: node,\n                index: index,\n                options: options\n              }">\n</ng-container>\n',styles:[":host{display:block;white-space:nowrap}.toggle-children-expanded .toggle-children{-webkit-transform:rotate(90deg);transform:rotate(90deg)}.toggle-children-collapsed .toggle-children{-webkit-transform:rotate(0);transform:rotate(0)}.toggle-children-wrapper{padding:0 3px;cursor:pointer}.toggle-children{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAASCAYAAABSO15qAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABAhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ1dWlkOjY1RTYzOTA2ODZDRjExREJBNkUyRDg4N0NFQUNCNDA3IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkYzRkRFQjcxODUzNTExRTU4RTQwRkQwODFEOUZEMEE3IiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkYzRkRFQjcwODUzNTExRTU4RTQwRkQwODFEOUZEMEE3IiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MTk5NzA1OGEtZDI3OC00NDZkLWE4ODgtNGM4MGQ4YWI1NzNmIiBzdFJlZjpkb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6YzRkZmQxMGMtY2NlNS0xMTc4LWE5OGQtY2NkZmM5ODk5YWYwIi8+IDxkYzp0aXRsZT4gPHJkZjpBbHQ+IDxyZGY6bGkgeG1sOmxhbmc9IngtZGVmYXVsdCI+Z2x5cGhpY29uczwvcmRmOmxpPiA8L3JkZjpBbHQ+IDwvZGM6dGl0bGU+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+5iogFwAAAGhJREFUeNpiYGBgKABigf///zOQg0EARH4A4gZyDIIZ8B/JoAJKDIDhB0CcQIkBRBtEyABkgxwoMQCGD6AbRKoBGAYxQgXIBRuZGKgAKPIC3QLxArnRSHZCIjspk52ZKMrOFBUoAAEGAKnq593MQAZtAAAAAElFTkSuQmCC);height:8px;width:9px;background-size:contain;display:inline-block;background-repeat:no-repeat;background-position:center}.toggle-children-placeholder{display:block;height:15px;width:15px}"]}]}],Z.propDecorators={options:[{type:h.Input}],node:[{type:h.Input}],index:[{type:h.Input}],template:[{type:h.Input}],className:[{type:h.HostBinding,args:["class.tree-node-expander"]}]};var _=function(){function e(e,t){this.virtualScroll=e,this.elementRef=t,this.className=!0}return e.prototype.ngOnInit=function(){this.node.elementRef=this.elementRef},e.prototype.ngOnDestroy=function(){this.node.elementRef=null},e.prototype.ngAfterViewInit=function(){this.virtualScroll.isDisabled()||this.virtualScroll.hasEnoughNodeHeight||this.virtualScroll.reportNodeHeight(this.elementRef.nativeElement.getBoundingClientRect().height)},e}();_.decorators=[{type:h.Component,args:[{selector:"ngx-tree-node-wrapper",template:'<ng-template [ngIf]="!templates.treeNodeWrapperTemplate">\n  <ngx-tree-node-expander [node]="node"\n                          [index]="index"\n                          [options]="options"\n                          [template]="templates.expanderTemplate"></ngx-tree-node-expander>\n\n  <ngx-tree-node-content [node]="node"\n                         [index]="index"\n                         [options]="options"\n                         [template]="templates.treeNodeTemplate">\n  </ngx-tree-node-content>\n</ng-template>\n\n<ng-container [ngTemplateOutlet]="templates.treeNodeWrapperTemplate"\n              [ngTemplateOutletContext]="{\n                $implicit: null,\n                node: node,\n                index: index,\n                options: options,\n                templates: templates\n              }">\n</ng-container>\n',styles:[":host{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}:host ::ng-deep .tree-node-content:hover{background-color:#f7fbff}:host(.ngx-tree-dragging-target) ::ng-deep .tree-node-expander{visibility:hidden}:host(.tree-node-wrapper-active) ::ng-deep .tree-node-content,:host(.tree-node-wrapper-active) ::ng-deep .tree-node-content:hover,:host(.tree-node-wrapper-active).tree-node-wrapper-focused ::ng-deep .tree-node-content{background-color:#beebff}:host(.tree-node-wrapper-focused) ::ng-deep .tree-node-content{background-color:#e7f4f9}:host ::ng-deep .tree-node-content:hover,:host(.tree-node-wrapper-active) ::ng-deep .tree-node-content,:host(.tree-node-wrapper-focused) ::ng-deep .tree-node-content{-webkit-box-shadow:inset 0 0 1px #999;box-shadow:inset 0 0 1px #999}:host(.is-dragging-over) .tree-node-content{position:relative;z-index:1;background-color:#dfe;-webkit-box-shadow:inset 0 0 1px #999;box-shadow:inset 0 0 1px #999;outline:#888 dashed 2px}:host(.is-dragging-over) .tree-node-content *,:host(.is-dragging-over) .tree-node-expander *{pointer-events:none}:host(.is-dragging-over-disabled) .tree-node-content{opacity:.5}"]}]}],_.ctorParameters=function(){return[{type:F},{type:h.ElementRef}]},_.propDecorators={node:[{type:h.Input}],options:[{type:h.Input}],index:[{type:h.Input}],templates:[{type:h.Input}],className:[{type:h.HostBinding,args:["class.tree-node-wrapper"]}]};var U=function(){function e(){this.className=!0}return Object.defineProperty(e.prototype,"allowDrop",{get:function(){var n=this;return function(e,t){return d(n.options.allowDrop)?n.options.allowDrop(e,{parent:n.node,index:e.index},t):n.options.allowDrop}},enumerable:!0,configurable:!0}),e.prototype.allowDrag=function(e){return d(this.options.allowDrag)?this.options.allowDrag(e):this.options.allowDrag},e}();U.decorators=[{type:h.Component,args:[{selector:"ngx-tree-node",template:'<ng-template [ngIf]="!templates.treeNodeFullTemplate">\n  <ngx-tree-node-wrapper [style.padding-left]="options.levelPadding(node)"\n                         [node]="node"\n                         [options]="options"\n                         [index]="index"\n                         [templates]="templates"\n                         [class.tree-node-wrapper-active]="node.isActive"\n                         [class.tree-node-wrapper-focused]="node.isFocused"\n                         (click)="node.mouseAction(\'click\', $event)"\n                         (dblclick)="node.mouseAction(\'dblClick\', $event)"\n                         (contextmenu)="node.mouseAction(\'contextMenu\', $event)"\n                         (ngxTreeDrop)="node.onDrop($event)"\n                         (treeDropDragOver)="node.mouseAction(\'dragOver\', $event)"\n                         (treeDropDragLeave)="node.mouseAction(\'dragLeave\', $event)"\n                         (treeDropDragEnter)="node.mouseAction(\'dragEnter\', $event)"\n                         [treeAllowDrop]="allowDrop"\n                         [ngxTreeDrag]="node"\n                         [treeDragEnabled]="allowDrag(node)">\n  </ngx-tree-node-wrapper>\n\n  <ngx-tree-node-children *ngIf="node.isExpanded && node.hasVisibleChildren"\n                          [node]="node"\n                          [options]="options"\n                          [children]="node.visibleChildren"\n                          [templates]="templates"></ngx-tree-node-children>\n</ng-template>\n\n<ng-container\n  [ngTemplateOutlet]="templates.treeNodeFullTemplate"\n  [ngTemplateOutletContext]="{ $implicit: null, node: node, index: index, options: options, templates: templates }">\n</ng-container>\n',styles:[":host{display:block;position:relative}"]}]}],U.propDecorators={node:[{type:h.Input}],options:[{type:h.Input}],index:[{type:h.Input}],templates:[{type:h.Input}],className:[{type:h.HostBinding,args:["class.tree-node"]}]};var $="disable-events-on-scroll",Y=function(){function e(e,t,n){this.virtualScroll=e,this.elementRef=t,this.renderer=n,this.lastScrollTop=0,this.isScrolling=!1,this.className=!0,this.ticking=!1,this.scrollIntoViewTicking=!1,this.structureChangeSub=u.Subscription.EMPTY,this.scrollIntoViewSub=u.Subscription.EMPTY}return e.prototype.onScroll=function(e){var t=this;if(this.disableEventsWhenScrolling(),!this.virtualScroll.isDisabled()){var n=this.elementRef.nativeElement.scrollTop;return Math.abs(n-this.lastScrollTop)<this.virtualScroll.averageNodeHeight||(this.lastScrollTop=n,this.ticking||(window.requestAnimationFrame(function(){t.setViewport(),t.ticking=!1}),this.ticking=!0),e.preventDefault(),e.stopPropagation()),!1}},e.prototype.ngOnInit=function(){var t=this;this.scrollIntoViewSub=this.treeModel.scrollIntoView$.subscribe(function(e){e.node.elementRef&&t.scrollIntoViewAndTick(e,function(){var e=t.lastScrollIntoViewTarget;e.node.elementRef.nativeElement.scrollIntoViewIfNeeded?e.node.elementRef.nativeElement.scrollIntoViewIfNeeded(e.scrollToMiddle):e.node.elementRef.nativeElement.scrollIntoView({behavior:"auto",block:"end"})})})},e.prototype.ngOnChanges=function(e){var t=this;if("treeModel"in e){if(this.virtualScroll.setDisabled(!this.enable),this.virtualScroll.isDisabled())return void(e.treeModel.isFirstChange()||this.treeModel.fireEvent({eventName:A.initialized}));this.initEventSubscription(),this.virtualScroll.reCalcPositions(this.treeModel),e.treeModel.isFirstChange()||setTimeout(function(){t.setViewport(),t.treeModel.fireEvent({eventName:A.initialized})})}},e.prototype.ngAfterViewInit=function(){var e=this;setTimeout(function(){e.virtualScroll.isDisabled()||(e.virtualScroll.reCalcPositions(e.treeModel),e.setViewport()),e.treeModel.fireEvent({eventName:A.initialized})})},e.prototype.ngOnDestroy=function(){this.structureChangeSub&&this.structureChangeSub.unsubscribe(),this.scrollIntoViewSub&&this.scrollIntoViewSub.unsubscribe()},e.prototype.scrollIntoViewAndTick=function(e,t){var n=this;this.lastScrollIntoViewTarget=e,this.scrollIntoViewTicking||(window.requestAnimationFrame(function(){t(),n.scrollIntoViewTicking=!1}),this.scrollIntoViewTicking=!0)},e.prototype.initEventSubscription=function(){var n=this;this.ngOnDestroy(),this.scrollIntoViewSub=this.treeModel.scrollIntoView$.subscribe(function(e){n.scrollIntoViewAndTick(e,function(){var e=n.lastScrollIntoViewTarget,t=n.virtualScroll.scrollIntoView(e.node,e.force,e.scrollToMiddle);t&&(n.elementRef.nativeElement.scrollTop=t)})}),this.structureChangeSub=u.merge(this.treeModel.events.expand,this.treeModel.events.collapse,this.treeModel.events.loadChildren,this.treeModel.events.changeFilter,this.treeModel.events.addNode,this.treeModel.events.removeNode).subscribe(function(){n.virtualScroll.reCalcPositions(n.treeModel),n.setViewport()})},e.prototype.setViewport=function(){this.virtualScroll.isDisabled()||this.virtualScroll.adjustViewport(this.elementRef.nativeElement.getBoundingClientRect(),this.lastScrollTop)},e.prototype.disableEventsWhenScrolling=function(){var e=this;this.scrollTimer?clearTimeout(this.scrollTimer):(this.isScrolling=!0,this.renderer.addClass(this.elementRef.nativeElement,$)),this.scrollTimer=setTimeout(function(){e.isScrolling=!1,e.renderer.removeClass(e.elementRef.nativeElement,$),e.scrollTimer=null},120)},e}();Y.decorators=[{type:h.Component,args:[{selector:"ngx-tree-viewport",template:"<ng-content></ng-content>\n",styles:[":host{height:100%;overflow:auto;display:block}"],providers:[F],changeDetection:h.ChangeDetectionStrategy.OnPush}]}],Y.ctorParameters=function(){return[{type:F},{type:h.ElementRef},{type:h.Renderer2}]},Y.propDecorators={enable:[{type:h.Input}],treeModel:[{type:h.Input}],className:[{type:h.HostBinding,args:["class.tree-viewport"]}],onScroll:[{type:h.HostListener,args:["scroll",["$event"]]}]};var W=function(t){function e(){var e=t.apply(this,E(arguments))||this;return e._draggedElement=null,e}return function(e,t){function n(){this.constructor=e}b(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(e,t),e.prototype.set=function(e){this._draggedElement=e},e.prototype.get=function(){return this._draggedElement},e.prototype.isDragging=function(){return!!this.get()},e}(u.Subject);W.decorators=[{type:h.Injectable}];var z=function(){function e(e){var n=this;this.treeDraggingTargetService=e,this.treeModel=null,this.refreshTree=!1,this.enableAnimation=!0,this.keepNodesExpanded=!1,this.expand=null,this.collapse=null,this.toggleExpander=null,this.activate=null,this.deactivate=null,this.focus=null,this.blur=null,this.initialized=null,this.moveNode=null,this.loadChildren=null,this.changeFilter=null,this.addNode=null,this.removeNode=null,this.className=!0,this.emitterMap=Object.keys(A).reduce(function(e,t){if(!n.hasOwnProperty(t))throw new TypeError("Unmatched events: ["+t+"]");return n[t]=e[t]=new h.EventEmitter,e},{}),this.UIOptions=I()}return e.prototype.ngOnChanges=function(e){var t=this;if(e.nodes&&e.nodes.currentValue){var n=this.treeModel;this.treeModel=new P(e.nodes.currentValue,this.emitterMap,this.dataOptions),n&&this.keepNodesExpanded&&n.expandedNodes.forEach(function(e){t.treeModel.setExpandedNodeInPlace(e)}),e.nodes.isFirstChange()||(this.refreshTree=!0)}else e.dataOptions&&e.dataOptions.currentValue&&this.treeModel&&this.treeModel.updateOptions(e.dataOptions.currentValue);e.focusTarget&&e.focusTarget.currentValue&&this.treeModel&&this.treeModel.focusNode(this.focusTarget),e.activateTarget&&e.activateTarget.currentValue&&this.treeModel&&this.treeModel.activateNode(this.activateTarget),(e.allowDrag||e.allowDrop||e.levelPadding||e.useVirtualScroll||e.nodeClass)&&(this.UIOptions=I({allowDrag:this.allowDrag,allowDrop:this.allowDrop,levelPadding:this.levelPadding,useVirtualScroll:this.useVirtualScroll,nodeClass:this.nodeClass}))},e.prototype.ngOnDestroy=function(){y(this.emitterMap,function(e){e.complete()})},e.prototype.onKeydown=function(e){if(this.treeModel.isFocused&&!["input","textarea"].includes(document.activeElement.tagName.toLowerCase())){var t=this.treeModel.focusedNode;this.treeModel.performKeyAction(t,e)}},e.prototype.onMousedown=function(e){e.target.closest("ngx-tree")||this.treeModel.setFocus(!1)},e.prototype.sizeChanged=function(){this.viewportComponent.setViewport()},e}();z.decorators=[{type:h.Component,args:[{selector:"ngx-tree",template:'<ngx-tree-viewport [@.disabled]="!enableAnimation || viewport.isScrolling"\n                   [enable]="useVirtualScroll"\n                   [treeModel]="treeModel"\n                   #viewport>\n  <div *ngIf="!viewport.virtualScroll.isDisabled()"\n       class="height-raiser"\n       [style.height.px]="treeModel?.virtualRoot.height"></div>\n  <div class="tree-root"\n       [class.node-dragging]="treeDraggingTargetService.isDragging()"\n       [class.virtual-scroll-disabled]="viewport.virtualScroll.isDisabled()"\n       [style.transform]="\'translateY(\' + root.marginTop + \'px)\'">\n    <ngx-tree-node-children #root\n                            [options]="UIOptions"\n                            [disableMarginTop]="true"\n                            [node]="treeModel?.virtualRoot"\n                            [children]="treeModel?.roots"\n                            [refreshTree]="refreshTree"\n                            [templates]="{\n                              expanderTemplate: expanderTemplate,\n                              loadingTemplate: loadingTemplate,\n                              treeNodeTemplate: treeNodeTemplate,\n                              treeNodeWrapperTemplate: treeNodeWrapperTemplate,\n                              treeNodeFullTemplate: treeNodeFullTemplate\n                            }">\n    </ngx-tree-node-children>\n  </div>\n</ngx-tree-viewport>\n',styles:[":host{display:block}ngx-tree-viewport{position:relative}ngx-tree-viewport.disable-events-on-scroll .tree-root /deep/ *{pointer-events:none}.tree-children{padding-left:20px}.height-raiser{-webkit-transition:height 250ms ease-in;transition:height 250ms ease-in}.tree-root{top:0;width:100%;height:100%;position:absolute;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.tree-root.virtual-scroll-disabled{position:static}/deep/ .ngx-tree-dragging-target *{pointer-events:none}"]}]}],z.ctorParameters=function(){return[{type:W}]},z.propDecorators={nodes:[{type:h.Input}],focusTarget:[{type:h.Input}],activateTarget:[{type:h.Input}],dataOptions:[{type:h.Input}],allowDrag:[{type:h.Input}],allowDrop:[{type:h.Input}],levelPadding:[{type:h.Input}],useVirtualScroll:[{type:h.Input}],nodeClass:[{type:h.Input}],enableAnimation:[{type:h.Input}],keepNodesExpanded:[{type:h.Input}],expand:[{type:h.Output}],collapse:[{type:h.Output}],toggleExpander:[{type:h.Output}],activate:[{type:h.Output}],deactivate:[{type:h.Output}],focus:[{type:h.Output}],blur:[{type:h.Output}],initialized:[{type:h.Output}],moveNode:[{type:h.Output}],loadChildren:[{type:h.Output}],changeFilter:[{type:h.Output}],addNode:[{type:h.Output}],removeNode:[{type:h.Output}],className:[{type:h.HostBinding,args:["class.ngx-tree"]}],loadingTemplate:[{type:h.ContentChild,args:["loadingTemplate"]}],expanderTemplate:[{type:h.ContentChild,args:["expanderTemplate"]}],treeNodeTemplate:[{type:h.ContentChild,args:["treeNodeTemplate"]}],treeNodeWrapperTemplate:[{type:h.ContentChild,args:["treeNodeWrapperTemplate"]}],treeNodeFullTemplate:[{type:h.ContentChild,args:["treeNodeFullTemplate"]}],viewportComponent:[{type:h.ViewChild,args:["viewport"]}],root:[{type:h.ViewChild,args:["root"]}],onKeydown:[{type:h.HostListener,args:["body: keydown",["$event"]]}],onMousedown:[{type:h.HostListener,args:["body: mousedown",["$event"]]}]};var Q="ngx-tree-dragging-target",J=function(){function e(e,t,n){this.el=e,this.renderer=t,this.treeDraggingTargetService=n}return e.prototype.onDragStart=function(e){e.dataTransfer.setData("text",this.draggingTarget.id),e.dataTransfer.dropEffect="move",this.renderer.addClass(this.el.nativeElement,Q),this.treeDraggingTargetService.set(this.draggingTarget),this.draggingTarget.mouseAction&&this.draggingTarget.mouseAction("dragStart",e)},e.prototype.onDragEnd=function(e){this.draggingTarget.mouseAction&&this.draggingTarget.mouseAction("dragEnd",e),this.renderer.removeClass(this.el.nativeElement,Q),this.treeDraggingTargetService.set(null)},e.prototype.ngOnChanges=function(e){"treeDragEnabled"in e&&this.renderer.setAttribute(this.el.nativeElement,"draggable",this.treeDragEnabled?"true":"false")},e}();J.decorators=[{type:h.Directive,args:[{selector:"[ngxTreeDrag]"}]}],J.ctorParameters=function(){return[{type:h.ElementRef},{type:h.Renderer2},{type:W}]},J.propDecorators={draggingTarget:[{type:h.Input,args:["ngxTreeDrag"]}],treeDragEnabled:[{type:h.Input}],onDragStart:[{type:h.HostListener,args:["dragstart",["$event"]]}],onDragEnd:[{type:h.HostListener,args:["dragend",["$event"]]}]};var X="is-dragging-over",q="is-dragging-over-disabled",K=function(){function e(e,t,n){this.el=e,this.renderer=t,this.treeDraggedElement=n,this.onDrop$=new h.EventEmitter,this.onDragOver$=new h.EventEmitter,this.onDragLeave$=new h.EventEmitter,this.onDragEnter$=new h.EventEmitter,this._allowDrop=function(e,t){return!0}}return Object.defineProperty(e.prototype,"treeAllowDrop",{get:function(){return this._allowDrop},set:function(n){this._allowDrop=d(n)?n:function(e,t){return n}},enumerable:!0,configurable:!0}),e.prototype.ngOnDestroy=function(){this.onDrop$.complete(),this.onDragEnter$.complete(),this.onDragLeave$.complete(),this.onDragOver$.complete()},e.prototype.onDragOver=function(e){this.allowDrop(e)&&(this.onDragOver$.emit({event:e,element:this.treeDraggedElement.get()}),this.dragOverClassAdded||this.addClass(),this._stopEvent(event))},e.prototype.onDragEnter=function(e){this.allowDrop(e)?(this.addClass(),this.onDragEnter$.emit({event:e,element:this.treeDraggedElement.get()}),this._stopEvent(event)):this.addDisabledClass()},e.prototype.onDragLeave=function(e){this.allowDrop(e)?(this.removeClass(),this.onDragLeave$.emit({event:e,element:this.treeDraggedElement.get()}),this._stopEvent(event)):this.removeDisabledClass()},e.prototype.onDrop=function(e){this.allowDrop(e)&&(this.removeClass(),this.onDrop$.emit({event:e,element:this.treeDraggedElement.get()}),this.treeDraggedElement.set(null),this._stopEvent(e))},e.prototype.allowDrop=function(e){return this._allowDrop(this.treeDraggedElement.get(),e)},e.prototype._stopEvent=function(e){e.preventDefault(),e.stopPropagation()},e.prototype.addClass=function(){this.dragOverClassAdded=!0,this.renderer.addClass(this.el.nativeElement,X)},e.prototype.removeClass=function(){this.dragOverClassAdded=!1,this.renderer.removeClass(this.el.nativeElement,X)},e.prototype.addDisabledClass=function(){this.disabledClassAdded=!0,this.renderer.addClass(this.el.nativeElement,q)},e.prototype.removeDisabledClass=function(){this.disabledClassAdded=!1,this.renderer.removeClass(this.el.nativeElement,q)},e}();K.decorators=[{type:h.Directive,args:[{selector:"[ngxTreeDrop]"}]}],K.ctorParameters=function(){return[{type:h.ElementRef},{type:h.Renderer2},{type:W}]},K.propDecorators={onDrop$:[{type:h.Output,args:["ngxTreeDrop"]}],onDragOver$:[{type:h.Output,args:["treeDropDragOver"]}],onDragLeave$:[{type:h.Output,args:["treeDropDragLeave"]}],onDragEnter$:[{type:h.Output,args:["treeDropDragEnter"]}],treeAllowDrop:[{type:h.Input}],onDragOver:[{type:h.HostListener,args:["dragover",["$event"]]}],onDragEnter:[{type:h.HostListener,args:["dragenter",["$event"]]}],onDragLeave:[{type:h.HostListener,args:["dragleave",["$event"]]}],onDrop:[{type:h.HostListener,args:["drop",["$event"]]}]};var ee,te=function(){function e(){}return e.forRoot=function(){return{ngModule:e,providers:[W,{provide:V,useValue:5}]}},e}();te.decorators=[{type:h.NgModule,args:[{imports:[m.CommonModule],declarations:[R,U,z,Z,_,j,G,Y,B,J,K],exports:[R,U,z,Z,_,j,G,Y,B,J,K]}]}],e.NgxTreeModule=te,e.TreeLoadingComponent=R,e.TreeNodeChildrenComponent=j,e.TreeNodeContentComponent=G,e.TreeNodeDropSlotComponent=B,e.TreeNodeExpanderComponent=Z,e.TreeNodeWrapperComponent=_,e.TreeNodeComponent=U,e.TreeViewportComponent=Y,e.TreeComponent=z,e.TreeDragDirective=J,e.TreeDropDirective=K,e.TreeDraggingTargetService=W,e.TreeVirtualScroll=F,e.VIRTUAL_SCROLL_NODE_HEIGHT_QUOTA=V,e.defaultUIOptions=C,e.defaultDataOptions=T,e.createTreeUIOptions=I,e.createTreeDataOptions=O,e.TreeModel=P,e.TreeNode=S,e.TREE_ACTIONS=w,e.defaultActionMapping=D,e.TREE_EVENTS=A,e.NUMBER_KEYS=x,e.STRING_KEYS={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown",ENTER:"Enter",SPACE:" "},Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=e-cloud-ngx-tree.umd.min.js.map
